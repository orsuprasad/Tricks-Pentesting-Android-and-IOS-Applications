## Android applications
### Architecture
<a href="https://developer.android.com/static/guide/platform/images/android-stack_2x.png">
    <img  height="650em" src="https://developer.android.com/static/guide/platform/images/android-stack_2x.png" />
</a>

### Components
Activities - show screens to the user and allow them to interact with those screens  
e.g.  
`am start -n <package_name>/<package_name>.<activity_name>`  

-> Create malicious app and call activity:  
```
Intent intent = new Intent();
intent.setClassName("<package_name>", "<package_name>.<activity_name>");
startActivity(intent);
```
Services - tasks that run in the background  
e.g.  
`am startservice -n <package_name>/<package_name>.<service_name>`  

Broadcast Receiver - operating system notifications   
e.g.  
`am broadcast -a android.intent.action.BOOT_COMPLETED`  

Content Provider - share information with other applications  
e.g.  
`content query --uri content://sms/sent`  

Create malicious app and call content provider:
```
Uri uri = Uri.parse("content://com.example.myapplication/ok.txt");
ContentResolver cr = getContentResolver();
Cursor c = cr.query(uri, cols, null, null, null);
```

### Proccess of Compiling
JVM - Java Virtual Machine  
.java -> javac(compiler)-> .class (bytecode)  

DVM - Dalvik Virtual Machine   
.java -> javac(compiler) -> .class(bytecode) -> dx(compiler) -> .dex(bytecode)  

ART - Android Runtime  
.java -> javac(compiler) -> .class(bytecode) -> dx(compiler) -> .dex(bytecode) -> dex2oat > native binary  

### Structure of an apk
AndroidManifest.xml - package name, permissions, components  
META-INF - app metadata  
classes.dex - binary dalvik byte code, contains the current application code  
res - resources used by the app  
resources.arsc -  android app resource file  

## Android Basics
### Debug Bridge  
-> Connect ADB  
`adb connect ip:5037`  
`adb shell`  

### Extract apk / Install apk
-> Access https://play.google.com/store/search?q=<name_app>&c=apps and get package name or url  
https://apkgk.com/APK-Downloader  
https://apps.evozi.com/apk-downloader/  
https://m.apkpure.com/br/  
https://auroraoss.com/  
or local  
`adb shell pm list packages -3 (list third party package)`  
`adb shell pm path <package_name> (Print the path to the .apk) `  
`adb pull <package_path> (get files from device)`  
`adb install example.apk (install apk on device)`  
-> Others  
https://adbshell.com/commands/adb-shell-pm-path

<img height=350 src="https://user-images.githubusercontent.com/54555784/224217908-c712c565-a3a0-4a12-9f76-4ca01f774f43.png">
<img height=200 src="https://user-images.githubusercontent.com/54555784/224217854-b3df6c1b-9eae-46e5-a710-0d636b294522.png">
